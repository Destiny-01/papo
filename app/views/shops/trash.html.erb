<%= stylesheet_link_tag "styles" %>

<%= simple_form_for(@shop) do |f| %>
  <%= f.error_notification %>
  <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>
  <% unless @shop.user_shot.blank %>
    <%# <%= image_tag @shop.user_shot.variant(resize: "800x600"), id: "previewImage" %> %>
  <% end %>

  <output id="list"></output>
  <div id="drop-zone" class="files form-inputs">Drag and Drop files here
    <br>
    <%= f.input :user_shot, label: false, input_html: { class: "file-input", type: "file" }, wrapper: false,
    label_html: { class: "file-label"} %>
  </div>
<div class="container">
	<div class="row">
	  <div class="col-md-6 float-center">
	      <form method="post" action="#" id="#">
           
              
              
              
              <%# <div class="form-group files">
                <h2 id="drop-zone" class="text-center">Drop Your Shot Here</h2> %>
                <%# <input type="file" class="form-control" multiple="true"> %>
                <%# <%= f.file_field :user_shot, multiple: true%>
              <%# </div> %> %>
          </form>
	  </div>
	</div>
</div>

  <%#= f.input :user_shot, label: false, input_html: { class: "file-input", type: "file" }, wrapper: false, label_html: { class: "file-label"} %>
  <%#= f.file_field :user_shot, multiple: true%>


  <div class="form-inputs">
   <div class="form-group files">
    <% if @shop.user_shot.attached? %>
      <p>
        <%= image_tag @shop.user_shot %>
      </p>
    <%else%>
      <%# <div id="drop-zone" class="text-center">Drop Your Shot Here</div> %>
        <%# <input type="file" class="form-control" multiple="true"> %>
        <%# <%= f.file_field :user_shot, multiple: true %> %>
    <% end %>
        <%#= f.input :user_shot, label: false, input_html: { class: "file-input", type: "file" }, wrapper: false, label_html: { class: "file-label"} %>
      </div>
    <%# <div id="drop-zone" class="text-center">Drop Your Shot Here</div> %>
    <%# <input type="file" class="form-control" multiple="true"> %>
    <%#= f.file_field :user_shot, multiple: true%>
    <%# <%= f.input :user_shot, label: false, input_html: { class: "file-input", type: "file" }, wrapper: false, label_html: { class: "file-label"} %> %>
    <%# <div class="mb-6"> %>
    <%# <%= f.label :user_shot, class: "label" %> %>
    <%# <div class="dropzone dropzone-default dz-clickable" data-controller="dropzone" data-dropzone-max-file-size="2" data-dropzone-max-files="1">
    <%= f.file_field :user_shot, direct_upload: true, data: { target: 'dropzone.input' } %> %>
    <%# <div class="dropzone-msg dz-message needsclick text-gray-600">
      <h3 class="dropzone-msg-title">Drag here to upload or click here to browse</h3>
      <span class="dropzone-msg-desc text-sm">2 MB file size maximum. Allowed file types png, jpg.</span>
      </div> %>
    </div>
  </div>
  </div>
    <%= f.input :title %>
    <%= f.input :description %>
  </div>

  <div class="form-actions">
    <%= f.submit"Create Shot", class: "btn btn-primary" %>
  </div>
<% end %>




<%= stylesheet_link_tag "styles" %>
<div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
    <ol class="carousel-indicators">
        <li data-bs-target="#first" data-bs-slide-to="0" class="active"></li>
        <li data-bs-target="#second" data-bs-slide-to="1" class="active"></li>
        <li data-bs-target="#third" data-bs-slide-to="2" class="active"></li>
    </ol>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <%= image_tag(@shop.images[1], style: 'width:50%; height:auto;', class: " ") unless @shop.images[1].blank? %>
            <%# <img src="/assets/test.jpg" class="d-block w-100" alt="test1"> %>
        </div>
        <div class="carousel-item active">
            <%= image_tag(@shop.images[0], style: 'width:100%; height:auto;', class: "") unless @shop.images[0].blank? %>
            <%# <img src="/assets/test.jpg" class="d-block w-100" alt="test2"> %>
        </div>
        <div class="carousel-item active">
            <%= image_tag(@shop.images[2], style: 'width:70%; height:auto;', class: " ") unless @shop.images[2].blank?  %>
            <%# <img src="/assets/test.jpg" class="d-block w-100" alt="test3"> %>
        </div>
    </div>
    <a class="carousel-control-prev" href="#first" role="button" data-bs-slide="prev">
        <%# <span class="carousel-control-prev-icon btn btn-dark" aria-hidden="true"></span> %>
        <div class="ico"> <i class="fa fa-arrow-left"></i></div>
        <span class="visually-hidden">Previous</span>
    </a>
    <a class="carousel-control-next omg" href="#second" role="button" data-bs-slide="next">
        <%# <span class="carousel-control-next-icon btn btn-dark" aria-hidden="true"></span> %>
           <div class="ico"> <i class="fa fa-arrow-right"></i></div>
        <span class="visually-hidden">Next</span>
    </a>
</div>

<%# <div class="carousel-item active"> %>
              <%#= image_tag(@shop.images[0], style: 'width:20%; height:auto;', class: "") %>
          <%# </div>
          <div class="carousel-item active"> %>
              <%#= image_tag(@shop.images[1], style: 'width:100%; height:auto;', class: "") %>
          <%# </div>
          <div class="carousel-item active"> %>
              <%#= image_tag(@shop.images[2], style: 'width:100%; height:auto;', class: "") %>
          <%# </div> %>

          
          <%# (0...@shop.images.count).each do |image| %>
            <%# <div style="width:300px; height:300px; "> %>
              <%#= image_tag(@shop.images[2], style: 'width:100%; height:auto;') %>
            <%# </div> %>
          <%# end %>
          <%# <%= @shop.user_shots.each do |user_shot| %> %>
              <%# <%= image_tag(user_shot) %> %>
            <%# <% end %> %>
            <%# <%= image_tag @shop.user_shots[0] %> %>
            <%# <%= image_tag @item.images, class: 'buy-item-img' %> %>




            <%= stylesheet_link_tag "shops" %>

<section class="section">
  <div class="shots grid">
    <% @shops.each do |shop| %>
      <div class="shot-grid-item">
        <div class="shot-wrapper ">
          <%= link_to shop, class: "shot" do %>
             <div class="img-fluid">
           <%# <%= cl_image_tag(shop.shots[0].key, class: "img-fluid", alt: "Image") unless shop.shots[0].blank? %><%#= image_tag "/assets/tes" </div> %> %>
           <%#= cloudinary_url(shop.thumbnail(0).key, class: "img-fluid", options = {}) unless shop.images[0].blank? %></div>
            <div class="shot-data">
              <h3 class="shot-title"><%= shop.title %></h3>
              <div class="shot-description"><%= truncate(shop.description, length: 60) %> </div>
              <div class="shot-time">
                <%= time_ago_in_words(shop.created_at) %>
              </div>
            </div>
          <% end %><br>

          <nav class="level shot-analytics">
            <div class="level-left">
            
            </div>
            <div class="level-right row ">
              <div class="level-item views data col-md-6 float-end">
                <%= link_to shop do %>
                  <span class="icon"><i class="fa fa-eye"></i></span>
                  <%= shop.impressionist_count %>
                <% end %>
              </div>
              <div class="level-item comments data col-md-3">
                <%= link_to shop do %>
                  <span class="icon"><i class="fa fa-comment"></i></span>
                  <%= shop.comments.count %>
                <% end %>
              </div>
              <div class="level-item likes data col-md-3">
                <% if user_signed_in? %>
                    <% if current_user.liked? shop %>
                        <%= link_to unlike_shop_path(shop), method: :put, class: "unlike_shop" do %>
                            <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                            <span class="vote_count"><%= shop.get_likes.size %> </span>
                        <% end %>
                    <% else %>
                        <%= link_to like_shop_path(shop), method: :put, class: "like_shop" do %>
                            <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                            <span class="vote_count"><%= shop.get_likes.size %> </span>
                        <% end %>
                    <% end %>
                <% else %>
                    <%= link_to like_shop_path(shop), method: :put, class: "like_shop" do %>
                        <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                        <span class="vote_count"><%= shop.get_likes.size %> </span>
                    <% end %>
                <% end %>
              </div>
            </div>
          </nav>
          <div class="user-data">
            <div class="user-thumb text-end">
              <%= gravatar_image_tag(shop.user.email.gsub("spam", "mdeering"), alt: shop.user.name, gravatar: { size: 20 }) %> <%= shop.user.name %> 
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
</section>






<div class="row">
            <div class="col-sm-6"></div>
            <div class="col-sm-6"><div class="level-right row justify-content-md-center ">
              <div class="level-item views data  col-lg-2 float-end">
                <%= link_to shop do%>
                  <span class="icon"><i class="fa fa-eye"><%= shop.impressionist_count%></i></span>
                  
                <% end %>
              </div>
              <div class="level-item comments data col-md-auto">
                <%= link_to shop do %>
                  <span class="icon"><i class="fa fa-comment"></i></span>
                  <%= shop.comments.count %>
                <% end %>
              </div>
              <div class="level-item likes data  col-lg-2">
                <% if user_signed_in? %>
                  <% if current_user.liked? shop %>
                    <%= link_to unlike_shop_path(shop), method: :put, class: "unlike_shop" do %>
                        <span class="icon"><i class="fa fa-heart vote-count "><span class="vote_count"><%= shop.get_likes.size %> </span> </i></span> 
                        
                    <% end %>
                  <% else %>
                    <%= link_to like_shop_path(shop), method: :put, class: "like_shop" do %>
                        <span class="icon"><i class="fa fa-heart vote-count "><span class="vote_count"><%= shop.get_likes.size %> </span> </i></span> 
                        
                    <% end %>
                  <% end %>
                <% else %>
                  <%= link_to like_shop_path(shop), method: :put, class: "like_shop" do %>
                    <span class="icon"><i class="fa fa-heart vote-count ">     </i></span> 
                    
                  <% end %>
                <% end %>
              </div>
            </div>
            </div>
          </div>












          <%= stylesheet_link_tag "styles" %>
<div class="section">
  <div class="container">
    <div class="row ">
      <div class="col-8" id="main">
        <h1 class="title"><%= @shop.title %> </h1>
        <span class="text-grey"></span>
        <h6 class="user-thumb ">
          by <%= gravatar_image_tag( @shop.user.email.gsub('spam', 'mdeering'), alt: @shop.user.name, class: "ms-3 totm", gravatar: { size: 20 }); %>  <%= @shop.user.name %> <span class="text-grey ms-3">  posted</span><span class="bt">
          <%= verbose_date(@shop.created_at)  %>
          </span>
        </h6>
        <div class="mobile float-end">
          <div class="level shot-analytics float-end av">
              <ul class="list-group list-group-horizontal">
                <li class="list-group-item">
                  <%= link_to @shop do%>
                    <span class="icon"><i class="fa fa-eye"><%= @shop.impressionist_count%></i></span>
                  <% end %>
                </li>
                <li class="list-group-item">
                  <%= link_to @shop do %>
                    <span class="icon"><i class="fa fa-comment"></i></span>
                    <%= @shop.comments.count %>
                  <% end %>
                </li>
                <li class="list-group-item">
                  <% if user_signed_in? %>
                    <% if current_user.liked? @shop %>
                      <%= link_to unlike_shop_path(@shop), method: :put, class: "unlike_shop" do %>
                          <span class="icon"><i class="fa fa-heart vote-count "><%= @shop.get_likes.size %></i></span> 
                          
                      <% end %>
                    <% else %>
                      <%= link_to like_shop_path(@shop), method: :put, class: "like_shop" do %>
                          <span class="icon"><i class="fa fa-heart vote-count "><%= @shop.get_likes.size %></i></span> 
                          
                      <% end %>
                    <% end %>
                  <% else %>
                    <%= link_to like_shop_path(@shop), method: :put, class: "like_shop" do %>
                      <span class="icon"><i class="fa fa-heart vote-count "> <%= @shop.get_likes.size %></i>
                      
                    <% end %>
                  <% end %>
                </li>
              </ul>
            </div>
          </div>
        </div>
        <br><br><br>
        <div class="grid">
          <div class="shot-container  pt-5">
            <div class="shot-full "><%= render 'carousel' %></div>
            <br>
            <h4 class="content container"><%= @shop.description %></h4>
            <br>
          </div>
        </div>
        <br>
        <% if user_signed_in? && (current_user.id == @shop.user_id) %>
          <%= link_to 'Edit', edit_shop_path(@shop), class: "btn btn-secondary" %>
          <%= link_to shop_path, method: :delete, data: {confirm: "Are You Sure?"}, class: "btn btn-outline-danger  ms-3" do %>
            <i class="fa fa-trash">  Delete</i><p></p>
          <% end %>
        <% end %>
      </div>
      <div class="col-4" id="other">
        <div class="row nav panel show-shot-analytics mt-5">
          <div class="row">
            <div class="col-12">
              <div class="list-group " id="list-tab" role="tablist">
                <a class="list-group-item list-group-item-action active" id="list-home-list" data-bs-toggle="list" href="#" role="tab" aria-controls="home"><span class="icon"><i class="fa fa-eye"></i></span> <%= pluralize(@shop.impressionist_count, 'View') %></a><hr>
                <a class="list-group-item list-group-item-action " id="list-profile-list" data-bs-toggle="list" href="#" role="tab" aria-controls="profile"><span class="icon"><i class="fa fa-comment"></i></span>  <%= pluralize(@shop.comments.count, 'Comment') %> </a><hr>
                <div class="ico me-5"> 
                <% if user_signed_in? %>
                  <% if current_user.liked? @shop %>
                      <%= link_to unlike_shop_path(@shop), method: :put, class: "unlike_shop" do %>
                          <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                      <% end %>
                          <span class="vote-count "><%= pluralize(@shop.get_likes.size, 'Like') %> </span>
                  <% else %>
                      <%= link_to like_shop_path(@shop), method: :put, class: "like_shop" do %>
                          <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                      <% end %>
                          <span class="vote-count"><%= pluralize(@shop.get_likes.size, 'Like') %> </span>
                  <% end %>
              <% else %>
                  <%= link_to like_shop_path(@shop), method: :put, class: "like_shop ms-5 btn ico" do %>
                      <span class="icon"><i class="fa fa-heart vote-count "> </i></span> 
                  <% end %>
                      <span class="vote-count"><%= pluralize(@shop.get_likes.size, 'Like') %> </span>
              <% end %>
              </div><hr>
                <%# <a class="list-group-item list-group-item-action" id="list-messages-list" data-bs-toggle="list" href="#" role="tab" aria-controls="messages"><span class="icon"><i class="fa fa-heart "></i></span> </a><hr> %>
              </div>
            </div>
            <%# <div class="col-8">
              <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">...</div>
                <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">...</div>
                <div class="tab-pane fade" id="list-messages" role="tabpanel" aria-labelledby="list-messages-list">...</div>
                <div class="tab-pane fade" id="list-settings" role="tabpanel" aria-labelledby="list-settings-list">...</div>
              </div>
            </div> %>
          </div>
        </div>
        
      </div>
      <section class="container comments mb-3"><br>
        <h2><%= pluralize(@shop.comments.count, 'Comment') %> </h2><hr/>
        <%= render @shop.comments %>
        <br>
        <% if user_signed_in? %>
          <div class="comment-form">
          <div class=""></div>
            <h2 class="text-center ">Leave a reply</h2>
            <div class=""><div class=""><%= render 'comments/form' %></div></div> 
          </div>
        <% else %>
          <div class="content"><%= link_to 'Sign In', new_user_session_path, class: "btn btn-primary" %>  to leave a comment</div>
        <% end %>
      </section><br>
    </div><br>
  </div>
</div>